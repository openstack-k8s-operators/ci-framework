---
- name: "Add hosts for group {{ group_item.key }}"
  ansible.builtin.add_host:
    name: "{{ host_item.key }}"
    groups: "{{ group_item.key }}"
    ansible_host: "{{ host_item.value.ansible_host | default(omit) }}"
    ansible_port: "{{ host_item.value.ansible_port | default(omit) }}"
    ansible_ssh_common_args: "{{ host_item.value.ansible_ssh_common_args | default(omit) }}"
    ansible_ssh_args: "{{ host_item.value.ansible_ssh_args | default(omit) }}"
    ansible_ssh_private_key_file: "{{ host_item.value.ansible_ssh_private_key_file | default(omit) }}"
    ansible_user: "{{ host_item.value.ansible_user | default(omit) }}"
    ansible_connection: "{{ host_item.value.ansible_connection | default(omit) }}"
    cifmw_hypervisor_host: "{{ host_item.value.cifmw_hypervisor_host | default(omit) }}"
  loop: "{{ group_item.value.hosts | dict2items }}"
  loop_control:
    loop_var: host_item
