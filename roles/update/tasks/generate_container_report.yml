---
# Copyright Red Hat, Inc.
# All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License"); you may
# not use this file except in compliance with the License. You may obtain
# a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
# License for the specific language governing permissions and limitations
# under the License.

- name: Execute container update report generation
  ansible.builtin.command:
    cmd: >
      python3 container_update_report.py
      --before-phase {{ cifmw_update_container_report_before_phase }}
      --after-phase {{ cifmw_update_container_report_after_phase }}
    chdir: "{{ cifmw_update_container_tracking_basedir }}"
  register: container_report_result

- name: Display container update report location
  ansible.builtin.debug:
    msg: |
      Container comparison reports generated:
      - JSON: {{ cifmw_update_container_tracking_basedir }}/container_report_{{ cifmw_update_container_report_before_phase }}_vs_{{ cifmw_update_container_report_after_phase }}.json
      - Summary: {{ cifmw_update_container_tracking_basedir }}/container_summary_{{ cifmw_update_container_report_before_phase }}_vs_{{ cifmw_update_container_report_after_phase }}.txt

- name: Display container update summary
  ansible.builtin.debug:
    msg: "{{ container_report_result.stdout }}"
  when: container_report_result.stdout is defined
