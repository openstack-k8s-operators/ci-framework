---
- name: Set update step to Starting the services update sequence
  ansible.builtin.command:
    cmd: >
      {{ cifmw_update_artifacts_basedir }}/update_event.sh
      Starting the services update sequence

- name: Run make update_services
  vars:
    make_update_services_env: "{{ cifmw_install_yamls_environment | combine({'PATH': cifmw_path }) }}"
    make_update_services_params: "{{ _make_update_params | from_yaml }}"
    make_update_services_dryrun: "{{ cifmw_update_run_dryrun | bool }}"
  ansible.builtin.include_role:
    name: 'install_yamls_makes'
    tasks_from: 'make_update_services'

- name: Set update step to Services update sequence complete
  ansible.builtin.command:
    cmd: >
      {{ cifmw_update_artifacts_basedir }}/update_event.sh
      Services update sequence complete

- name: Set update step to Starting the system update sequence
  ansible.builtin.command:
    cmd: >
      {{ cifmw_update_artifacts_basedir }}/update_event.sh
      Starting the system update sequence

- name: Run make update_system
  vars:
    make_update_system_env: "{{ cifmw_install_yamls_environment | combine({'PATH': cifmw_path }) }}"
    make_update_system_params: "{{ _make_update_params | from_yaml }}"
    make_update_system_dryrun: "{{ cifmw_update_run_dryrun | bool }}"
  ansible.builtin.include_role:
    name: 'install_yamls_makes'
    tasks_from: 'make_update_system'

- name: Set update step to System update sequence complete
  ansible.builtin.command:
    cmd: >
      {{ cifmw_update_artifacts_basedir }}/update_event.sh
      System update sequence complete
