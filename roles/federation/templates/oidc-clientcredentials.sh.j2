#!/bin/bash
# OIDC Client Credentials flow configuration
# This script configures authentication using OAuth 2.0 Client Credentials grant type
# The client authenticates directly with Keycloak using client_id and client_secret

unset OS_CLOUD
export OS_CACERT=/home/cloud-admin/full-ca-list.crt
export OS_AUTH_URL="{{ cifmw_federation_keystone_url }}/v3"
export OS_IDENTITY_API_VERSION=3
export OS_AUTH_TYPE=v3oidcclientcredentials
export OS_IDENTITY_PROVIDER="{{ cifmw_federation_IdpName }}"
export OS_CLIENT_ID="{{ cifmw_federation_keystone_OIDC_ClientID }}"
export OS_CLIENT_SECRET="{{ cifmw_federation_keystone_OIDC_ClientSecret }}"
export OS_OPENID_SCOPE="openid profile email"
export OS_PROTOCOL=openid
export OS_ACCESS_TOKEN_TYPE=access_token
export OS_DISCOVERY_ENDPOINT="{{ cifmw_federation_keycloak_url }}/auth/realms/{{ cifmw_federation_keycloak_realm }}/.well-known/openid-configuration"
