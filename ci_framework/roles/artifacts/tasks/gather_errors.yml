---
- name: Gather all errrors in a single file
  ansible.builtin.shell: |
    grep -rE '^[-0-9]+ [0-9:\.]+ [0-9 ]*ERROR ' {{ cifmw_artifacts_basedir }}/logs |
    sed "s/\(.*\)\(20[0-9][0-9]-[0-9][0-9]-[0-9][0-9] [0-9][0-9]:[0-9][0-9]:[0-9][0-9]\.[0-9]\+\)\(.*\)/\2 ERROR \1\3/g" > /tmp/errors.txt;
    mv /tmp/errors.txt {{ cifmw_artifacts_basedir }}/logs/errors.txt
  ignore_errors: true
