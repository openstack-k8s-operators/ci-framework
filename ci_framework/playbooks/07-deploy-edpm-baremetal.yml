- name: Run pre_deploy hooks
  vars:
    hooks: "{{ pre_deploy | default([]) }}"
    step: pre_deploy
  ansible.builtin.import_playbook: ./hooks.yml

- hosts: "{{ cifmw_target_host | default('localhost') }}"
  gather_facts: false
  tasks:
    - name: Call predeploy
      ansible.builtin.include_role:
        name: edpm_prepare

    - name: Call make_edpm_compute_baremetal target
      ansible.builtin.include_role:
        name: 'install_yamls_makes'
        tasks_from: 'make_edpm_compute_baremetal'
      vars:
        make_edpm_compute_baremetal_env:
          BMO_SETUP: true

    - name: wait for 10 mins
      ansible.builtin.shell:
        sleep 600
        oc get bmh
        oc get openstackdataplane
- name: Run post_deploy hooks
  vars:
    hooks: "{{ post_deploy | default([]) }}"
    step: post_deploy
  ansible.builtin.import_playbook: ./hooks.yml
