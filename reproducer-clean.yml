- name: Clean reproducer layout
  hosts: "{{ cifmw_target_host | default('localhost') }}"
  gather_facts: true
  tasks:
    - name: Call reproducer.cleanup
      tags:
        - libvirt_layout
      ansible.builtin.import_role:
        name: reproducer
        tasks_from: cleanup.yml

    - name: Clean up devscripts related content
      tags:
        - devscripts_layout
      when:
        - cifmw_use_devscripts | default(false) | bool
      ansible.builtin.import_role:
        name: devscripts
        tasks_from: cleanup.yml

    - name: Remove basedir
      tags:
        - deep_scrub
      ansible.builtin.file:
        path: "{{ cifmw_reproducer_basedir }}"
        state: absent

    - name: Clear all facts
      tags:
        - deep_scrub
      ansible.builtin.meta: clear_facts
