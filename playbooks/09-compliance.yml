- name: Run compliance scan for controllers
  hosts: "{{ cifmw_target_host | default('localhost') }}"
  gather_facts: false
  tasks:
    - name: Run compliance scan for controllers
      ansible.builtin.import_role:
        name: compliance
      when: cifmw_run_controller_compliance_scans | default('false') | bool

- name: Run compliance scan for computes
  hosts: "{{ groups['computes'] | first }}"
  gather_facts: false
  tasks:
    - name: Run compliance scan for first compute
      ansible.builtin.import_role:
        name: compliance
        tasks_from: run_compute_node_scans.yml
      when: cifmw_run_compute_compliance_scans | default('false') | bool
