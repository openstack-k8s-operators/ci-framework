---
# NOTE: This is a required workaround, that would help us to drop
# nested Ansible execution. The Zuul executor does not have the
# cimfw collection installed, so on directly calling the roles, that
# are using cifmw.general.ci_script or cifmw.general.discover_latest_image
# or other, it will fail with an error:
#   couldn't resolve module/action
# This playbook would make a symlink to .ansible collection dir, so in the
# next playbook execution, module should be available.
- name: Make symlink of cifmw general collection to Zuul Ansible workdir
  hosts: localhost
  tasks:
    - name: Make a symlink to local .ansible collection dir
      ansible.builtin.include_role:
        name: cifmw_helpers
        tasks_from: symlink_cifmw_collection.yml
